# ===================================================================
# Performance Optimization Commands and Toggles
# ===================================================================

# Performance toggle commands
alias enable_previews chain set preview_files true; set preview_directories true; set use_preview_script true
alias disable_previews chain set preview_files false; set preview_directories false; set use_preview_script false
alias enable_images chain set preview_images true; set preview_images_method w3m
alias disable_images set preview_images false
alias enable_vcs chain set vcs_aware true; set vcs_backend_git enabled
alias disable_vcs chain set vcs_aware false; set vcs_backend_git disabled

# Fast directory navigation
alias fastmode chain disable_previews; disable_images; disable_vcs; set freeze_files true
alias fullmode chain enable_previews; enable_images; enable_vcs; set freeze_files false

# Memory cleanup
alias cleanup shell find ~/.cache/ranger -type f -name "*.jpg" -delete 2>/dev/null
alias cleanup_all shell rm -rf ~/.cache/ranger/* 2>/dev/null

# Quick directory size calculation (lightweight alternative to du)
alias size shell wc -l <<< "$(find . -maxdepth 1 -type f)" && echo " files in current directory"

# ===================================================================
# == KEY MAPPINGS - Joshuto Style (Optimized) ==
# ===================================================================

# Core navigation (vim-like, matching joshuto)
map j move down=1
map k move up=1  
map h move left=1
map l move right=1
map gg move to=0
map G move to=-1

# Arrow key alternatives
map <UP> move up=1
map <DOWN> move down=1
map <LEFT> move left=1
map <RIGHT> move right=1
map <HOME> move to=0
map <END> move to=-1

# Page navigation
map <PAGEUP> move up=1 pages=True
map <PAGEDOWN> move down=1 pages=True
map <C-u> move up=0.5 pages=True
map <C-d> move down=0.5 pages=True

# Tab management (matching joshuto)
map <C-t> tab_new
map <C-w> tab_close
map q tab_close
map Q quitall
map <TAB> tab_move 1
map <S-TAB> tab_move -1
map <A-1> tab_open 1
map <A-2> tab_open 2
map <A-3> tab_open 3
map <A-4> tab_open 4
map <A-5> tab_open 5

# File operations (joshuto style)
map dd cut
map yy copy
map pp paste
map po paste overwrite=True
map dD delete
map <DELETE> shell gio trash %s

# Selection and marking
map <SPACE> mark_files toggle=True
map <C-a> mark_files all=True toggle=True
map v toggle_visual_mode

# Rename operations
map a rename_append
map A rename_prepend

# Quick access console commands
map : console
map ; console
map cd console cd%space
map t console touch%space
map <C-n> console mkdir%space

# Search (optimized for large directories)
map / console scout -ftsea%space
map n search_next
map N search_next forward=False
map <C-f> console search%space

# Sorting (matching joshuto)
map sr set sort_reverse!
map sl set sort=basename
map sm set sort=mtime
map sn set sort=natural  
map ss set sort=size
map se set sort=extension

# Performance toggles
map zp fastmode
map zP fullmode  
map zi enable_images
map zI disable_images
map zv enable_previews
map zV disable_previews

# System integration
map R reload_cwd
map <C-h> set show_hidden!
map <C-r> reset
map <C-l> redraw_window
map <ESC> redraw_window

# Shell and external programs  
map - console shell%space
map T shell bash
map E shell feh %f &
map o console open_with%space

# Directory shortcuts (matching joshuto bookmarks)
map gr cd /
map gc cd ~/.config
map gd cd ~/Downloads  
map gh cd ~/
map gp cd ~/Documents/Projects
map gs cd ~/.scripts
map gv cd ~/.virtualenv
map gm cd /home/media/
map ge cd ~/Documents/Github/

# Utility commands
map w taskview_open
map ? help
map bb bulkrename

# Archive operations  
map z console shell zip -r archive.zip %s

# Copy operations (joshuto style)
map yn shell echo -n %f | xsel -i -b
map y. shell echo -n %f | sed 's/\.[^.]*$//' | xsel -i -b
map yp shell echo -n %d/%f | xsel -i -b  
map yd shell echo -n %d | xsel -i -b

# Symlink operations
map pl paste_symlink relative=False
map pL paste_symlink relative=True

# Parent navigation
map [ move_parent -1
map ] move_parent 1

# Line modes
map ms linemode sizemtime
map mm linemode mtime

# Cleanup and maintenance
map zc cleanup
map zC cleanup_all

# ===================================================================
# == CONSOLE MAPPINGS ==
# ===================================================================

# Console navigation
cmap <TAB> eval fm.ui.console.tab()
cmap <S-TAB> eval fm.ui.console.tab(-1)
cmap <ESC> eval fm.ui.console.close()
cmap <CR> eval fm.ui.console.execute()
cmap <C-l> redraw_window

# Console history
cmap <UP> eval fm.ui.console.history_move(-1)
cmap <DOWN> eval fm.ui.console.history_move(1)

# Console editing
cmap <LEFT> eval fm.ui.console.move(left=1)
cmap <RIGHT> eval fm.ui.console.move(right=1)
cmap <HOME> eval fm.ui.console.move(right=1, absolute=True)
cmap <END> eval fm.ui.console.move(left=1, absolute=True)
cmap <BACKSPACE> eval fm.ui.console.delete(-1)
cmap <DELETE> eval fm.ui.console.delete(0)
cmap <C-w> eval fm.ui.console.delete_word()
cmap <C-k> eval fm.ui.console.delete_rest(1)
cmap <C-u> eval fm.ui.console.delete_rest(-1)

# ===================================================================
# == TASK VIEW MAPPINGS ==  
# ===================================================================

tmap <UP> taskview_move up=1
tmap <DOWN> taskview_move down=1
tmap <HOME> taskview_move to=0  
tmap <END> taskview_move to=-1
tmap j taskview_move down=1
tmap k taskview_move up=1
tmap gg taskview_move to=0
tmap G taskview_move to=-1
tmap <ESC> taskview_close
tmap w taskview_close
tmap q taskview_close

# ===================================================================
# == PAGER MAPPINGS ==
# ===================================================================

pmap <DOWN> pager_move down=1
pmap <UP> pager_move up=1
pmap <LEFT> pager_move left=4
pmap <RIGHT> pager_move right=4
pmap <HOME> pager_move to=0
pmap <END> pager_move to=-1
pmap <PAGEDOWN> pager_move down=1.0 pages=True
pmap <PAGEUP> pager_move up=1.0 pages=True
pmap <C-d> pager_move down=0.5 pages=True
pmap <C-u> pager_move up=0.5 pages=True

pmap j pager_move down=1
pmap k pager_move up=1
pmap h pager_move left=4
pmap l pager_move right=4  
pmap gg pager_move to=0
pmap G pager_move to=-1
pmap <ESC> pager_close
pmap q pager_close
